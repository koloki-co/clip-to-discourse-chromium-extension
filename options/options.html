<!-- SPDX-FileCopyrightText: 2025 Marcus Baw / Koloki Ltd -->
<!-- SPDX-License-Identifier: GPL-3.0-only -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Clip to Discourse Settings</title>
    <link rel="stylesheet" href="options.css" />
  </head>
  <body>
    <main class="container">
      <!-- Page header and description -->
      <header class="header">
        <div class="brand">
          <img class="brand-mark" src="../assets/images/clip-to-discourse-logo.svg" alt="Clip to Discourse logo" />
          <div class="brand-copy">
            <h1>Clip to Discourse Settings</h1>
            <p>Connect your Discourse instance and set defaults.</p>
          </div>
        </div>
      </header>

      <form id="settings-form">
        <!-- Profile management -->
        <section class="section">
          <h2>Profiles</h2>
          <label>
            Active Profile
            <select id="profileSelect" name="profileSelect"></select>
          </label>
          <label>
            Profile Name
            <input id="profileName" name="profileName" type="text" placeholder="e.g. Personal" />
          </label>
          <div class="actions">
            <button class="secondary" type="button" id="addProfile">Add Profile</button>
            <button class="secondary" type="button" id="deleteProfile">Delete Profile</button>
          </div>
        </section>

        <!-- Toolbar icon appearance -->
        <section class="section">
          <h2>Appearance</h2>
          <label class="checkbox">
            <input id="useFaviconForIcon" name="useFaviconForIcon" type="checkbox" />
            Use destination site favicon for the toolbar icon
          </label>
        </section>

        <!-- Connection credentials -->
        <section class="section">
          <h2>Connection</h2>
          <label>
            Discourse BaseURL
            <input id="baseUrl" name="baseUrl" type="url" placeholder="https://forum.example.com" required />
            <span id="baseUrlError" class="error"></span>
          </label>
          <label>
            Discourse API Username
            <input id="apiUsername" name="apiUsername" type="text" placeholder="clipbot" required />
            <span id="apiUsernameError" class="error"></span>
          </label>
          <label>
            Discourse API Key
            <input id="apiKey" name="apiKey" type="password" required />
            <span id="apiKeyError" class="error"></span>
            <span class="hint">Use a user-scoped API key with Granular scope: Topics read (for test), write, update.</span>
          </label>
        </section>

        <!-- Default clip behavior -->
        <section class="section">
          <h2>Defaults</h2>
          <label>
            Default Clip Style
            <select id="defaultClipStyle" name="defaultClipStyle">
              <option value="title_url">Title + URL</option>
              <option value="excerpt">Title + URL + excerpt</option>
              <option value="full_text">Full page text</option>
            </select>
          </label>
          <label>
            Default Destination
            <select id="defaultDestination" name="defaultDestination">
              <option value="new_topic">Create new topic</option>
              <option value="append_topic">Append to existing topic</option>
            </select>
          </label>
          <div class="grid">
            <label>
              Default Category ID
              <input id="defaultCategoryId" name="defaultCategoryId" type="number" min="1" placeholder="4" />
            </label>
            <label>
              Default Topic ID
              <input id="defaultTopicId" name="defaultTopicId" type="number" min="1" placeholder="e.g. 345" />
            </label>
          </div>
          <h2>Templates</h2>
          <label>
            Title (used for New Topic clipping only)
            <input id="titleTemplate" name="titleTemplate" type="text" placeholder="Clip: {{title}}" />
            <span class="hint">Required: {{title}}. Optional: {{date}}, {{datetime}}.</span>
          </label>
          <label>
            Title + URL Template
            <textarea id="titleUrlTemplate" name="titleUrlTemplate" rows="4" placeholder="### {{title}}&#10;{{url}}"></textarea>
            <span class="hint">Defaults to the built-in template when left blank.</span>
            <span class="hint">Use {{title}}, {{url}}, {{date}}, {{datetime}}, {{text-selection}}, {{text-selection-markdown}}.</span>
          </label>
          <label>
            Title + URL + Excerpt Template
            <textarea id="excerptTemplate" name="excerptTemplate" rows="6" placeholder="### {{title}}&#10;{{url}}&#10;&#10;{{excerpt}}&#10;&#10;{{url}}"></textarea>
            <span class="hint">Defaults to the built-in template when left blank.</span>
            <span class="hint">Use {{excerpt}} (Markdown) or {{excerpt-plain}}, plus Title + URL placeholders.</span>
          </label>
          <label>
            Full Page Text Template
            <textarea id="fullTextTemplate" name="fullTextTemplate" rows="6" placeholder="### {{title}}&#10;{{url}}&#10;&#10;---&#10;&#10;{{full-text}}&#10;&#10;---&#10;&#10;{{url}}"></textarea>
            <span class="hint">Defaults to the built-in template when left blank.</span>
            <span class="hint">Use {{full-text}} (Markdown), {{full-text-plain}}, {{full-text-markdown}}, plus Title + URL placeholders.</span>
          </label>
        </section>

        <div class="actions">
          <button class="secondary" type="button" id="testConnection">Test Connection</button>
          <button class="primary" type="submit">Save Settings</button>
        </div>
        <p id="status" class="status" role="status"></p>
      </form>
    </main>

    <script type="module" src="options.js"></script>
  </body>
</html>
